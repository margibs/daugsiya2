{"version":3,"sources":["home.js","gameSearch.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACvgDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"main.js","sourcesContent":["$(function(){\n\n\tBASE_URL = $('meta[name=\"baseURL\"]').attr('content');\n\tCSRF_TOKEN = $('meta[name=\"csrf-token\"]').attr('content');\n\tsocket = io.connect(BASE_URL+':8891');\n\tdefaultProfilePic = BASE_URL+'/images/default_profile_picture.png';\n\n\t//USER DETAILS\n\tuserImage = $('#userId').data('image');\n\tuserId = $('#userId').val();\n    userName = $('#userId').data('name');\n    isAdmin = $('#userId').data('isAdmin') == 1 ? true : false;\n    sessionId = $('#sessionId').val();\n    //END USER DETAILS\n\n    var profileUrl = BASE_URL+'/profile',\n    \tnotifUrl = BASE_URL+'/notification',\n    \tmessageUrl = BASE_URL+'/message',\n    \tfriendUrl = BASE_URL+'/friends';\n\n\t$.fn.preload = function() {\n\t\tthis.each(function(){\n\t\t\t$('<img/>')[0].src = this;\n\t\t});\n\t}\n\n\t$(['http://susanwins.com/uploads/64878_click-header.png']).preload();\n\n\n\t//SOCKET ON\n\n\tsocket.on('user_logged_in', function(){\n\t\tlocation.reload();\n\t});\n\n\tsocket.on('user_logged_out', function(){\n\t\tlocation.reload();\n\t});\n\n\tsocket.on('connect', function(){\n\n\t\tif(userId)\n\t\t{\n\t\t  socket.emit('login', { user_id : userId , profile_picture : userImage, name : userName, session_id : sessionId }, false, isAdmin);\n\t\t}\n\t\telse\n\t\t{\n\t\t  socket.emit('look_at_room', sessionId);\n\t\t}\n\n\t});\n\n\n\tsocket.on('user_banned', function(data, room_id){\n\t\tconsole.log('user_banned');\n\t\tconsole.log($('#chatbox-'+room_id));\n\t\tconsole.log($('#chatbox-'+room_id).length);\n      if(data.user_id == userId && $('#chatbox-'+room_id).length ){\n        $('#chatbox-'+room_id).find('textarea').initBan(data.time);\n        $('#')\n      }\n\n   });\n\n\n   socket.on('lift_ban', function(user_id, room_id){\n      console.log('lift_ban');\n      console.log(user_id);\n      console.log(room_id);\n      if(user_id == userId && $('#chatbox-'+room_id).length){\n        \n        clearInterval($('#chatbox-'+room_id).find('textarea').data('time_interval'));\n        $('#chatbox-'+room_id).find('textarea').attr('placeholder', 'Type Message').removeAttr('disabled');\n\n      }\n\n   });\n\n\n   $.fn.initBan = function(time){\n\n        function millisToMinutesAndSeconds(millis) {\n          var minutes = Math.floor(millis / 60000);\n          var seconds = ((millis % 60000) / 1000).toFixed(0);\n          return minutes + \":\" + (seconds < 10 ? '0' : '') + seconds;\n        }\n\n        function countRemaining(input){\n\n          remaining_time = $(input).data('remaining_time');\n\n          remaining_time = remaining_time - 1000;\n\n          if(remaining_time > 0){\n\n            $(input).data('remaining_time', remaining_time);\n            $(input).removeData('remaining_time').data('remaining_time', remaining_time);\n             $(input).attr('placeholder' ,'Banned for '+millisToMinutesAndSeconds(remaining_time)).attr('disabled', 'disabled');\n\n          }else{\n            clearInterval($(input).data('time_interval'));\n            $(input).attr('placeholder', 'Type Message').removeAttr('disabled');\n          }\n\n          \n\n        }\n\n        return this.each(function(){\n\n          input = this;\n\n          $(input).attr('disabled', 'disabled');\n\n          $(input).removeData('remaining_time').data('remaining_time', time);\n\n          $(input).attr('placeholder' ,'Banned for '+millisToMinutesAndSeconds(time));\n\n          if($(input).data('time_interval')){\n\n            clearInterval($(input).data('time_interval'));\n\n          }\n\n          $(input).data('time_interval', \n\n            setInterval(countRemaining, 1000, input)\n\n            )\n\n\n\n        });\n\n      }\n\n\n\n\tsocket.on('post_recommendGame_notification', function(friend){\n\n\t\tconsole.log('post_recommendGame_notification');\n\n\t\tspan = $('<span>').addClass('notifcount');\n\t\tnotifcount = 1;\n\n\t\tif($('#unreadUserNotification').find('.notifcount').length)\n\t\t{\n\t\t  notifcount = parseInt($('#unreadUserNotification').find('.notifcount').text())+1;\n\t\t}\n\n\t\t$('#unreadUserNotification').html('').append($(span).text(notifcount));\n\n\n\t\t$('#myNotifications').prepend(\n\t\t  $('<li>').append(\n\t\t    $('<a href=\"'+BASE_URL+'/'+friend.game.slug+'\">').addClass('unread')\n\t\t    .append(\n\t\t      $('<img>').attr('src', friend.user.user_detail.profile_picture ? BASE_URL+'/'+friend.user.user_detail.profile_picture : defaultProfilePic )\n\t\t    )\n\t\t    .append(\n\t\t      $('<p>')\n\t\t      .append(\n\t\t        $('<span>').addClass('name').text(friend.user.user_detail.firstname+' '+friend.user.user_detail.lastname+' recommended you to play. ')\n\t\t      )\n\t\t      .append(\n\t\t        $('<div>').addClass('actionList')\n\t\t        .append(\n\t\t          $('<span>').text('Click to Play')\n\t\t        )\n\t\t      )\n\t\t    )\n\t\t  )\n\t\t);\n\t});\n\n\tsocket.on('post_accepted_friend_notification', function(friend){\n\t\tspan = $('<span>').addClass('notifcount');\n\t\tnotifcount = 1;\n\n\t\tif($('#unreadUserNotification').find('.notifcount').length)\n\t\t{\n\t\t  notifcount = parseInt($('#unreadUserNotification').find('.notifcount').text())+1;\n\t\t}\n\n\t\t$('#unreadUserNotification').html('').append($(span).text(notifcount));\n\n\t\t$('#myNotifications').prepend(\n\t\t  $('<li>').append(\n\t\t    $('<a href=\"javascript:;\">').addClass('unread')\n\t\t    .append(\n\t\t      $('<img>').attr('src', friend.profile_picture ? BASE_URL+'/'+friend.profile_picture : defaultProfilePic )\n\t\t    )\n\t\t    .append(\n\t\t      $('<p>')\n\t\t      .append(\n\t\t        $('<span>').addClass('name').text('You and '+friend.name+' are now friends!')\n\t\t      )\n\t\t      .append(\n\t\t        $('<div>').addClass('actionList').data('user', friend.user_id)\n\t\t        .append(\n\t\t          $('<button>').text('Message').addClass('subModalToggle pmFriend').attr('data-target', '#pmBox')\n\t\t        )\n\t\t      )\n\t\t    )\n\t\t  )\n\t\t);\n\t});\n\n\tsocket.on('post_global_notification', function(notification){\n\n\t  console.log('post_global_notification');\n\t  console.log(notification);\n\n\t  if(notification)\n\t  {\n\t    span = $('<span>').addClass('notifcount');\n\t    notifcount = 1;\n\n\t    if($('#unreadGlobalNotification').find('.notifcount').length)\n\t    {\n\t      notifcount = parseInt($('#unreadGlobalNotification').find('.notifcount').text())+1;\n\t    }\n\n\t    $('#unreadGlobalNotification').html('').append($(span).text(notifcount));\n\n\t    if(notification.type == 1)\n\t    {\n\n\t      $('#myGlobalNotifications').prepend(\n\t        $('<li>')\n\t        .append(\n\t          $('<a href=\"'+BASE_URL+'/'+notification.game.slug+'\">').addClass('unread')\n\t          .append(\n\t            $('<p>')\n\t            .append(\n\t              $('<span>').text('New Game has Added!')\n\t            )\n\t          )\n\t        )\n\t      );\n\n\t    }\n\t    else if(notification.type == 2)\n\t    {\n\n\t      $('#myGlobalNotifications').prepend(\n\t        $('<li>')\n\t        .append(\n\t          $('<a href=\"'+BASE_URL+'/clubhouse/chatroom/'+notification.room.name+'\">').addClass('unread')\n\t          .append(\n\t            $('<p>')\n\t            .append(\n\t              $('<span>').text('New Chatroom Created!')\n\t            )\n\t          )\n\t        )\n\t      );\n\n\t    }\n\t    else if(notification.type == 3)\n\t    {\n\n\t      $('#myGlobalNotifications').prepend(\n\t        $('<li>')\n\t        .append(\n\t          $('<a href=\"'+BASE_URL+'/clubhouse/chatroom/'+notification.room.name+'\">').addClass('unread')\n\t          .append(\n\t            $('<p>')\n\t            .append(\n\t              $('<span>').text(notification.moderator.user_detail.firstname+' '+notification.moderator.user_detail.lastname+' is now in '+notification.room.name)\n\t            )\n\t          )\n\t        )\n\t      );\n\t    }\n\t    else if(notification.type == 4)\n\t    {\n\n\t      $('#myGlobalNotifications').prepend(\n\t        $('<li>')\n\t        .append(\n\t          $('<a href=\"//'+ notification.custom_notification.link +' \">').addClass('unread')\n\t          .append(\n\t            $('<p>')\n\t            .append(\n\t              $('<span>').text(notification.custom_notification.description)\n\t            )\n\t          )\n\t        )\n\t      );\n\t    }\n\t  }\n\t});\n\n\tsocket.on('post_custom_notification', function(notification){\n\t  $.each(notification, function(){\n\t    data = this;\n\t    span = $('<span>').addClass('notifcount');\n\t    notifcount = 1;\n\t    if($('#unreadGlobalNotification').find('.notifcount').length){\n\t      notifcount = parseInt($('#unreadGlobalNotification').find('.notifcount').text())+1;\n\t    }\n\n\t    $('#unreadGlobalNotification').html('').append($(span).text(notifcount));\n\n\t    $('#myGlobalNotifications').prepend(\n\t      $('<li>')\n\t          .append(\n\t            $('<a href=\"//'+ data.custom_notification.link +' \">').addClass('unread')\n\t                  .append(\n\t                    $('<p>')\n\t                      .append(\n\t                        $('<span>').text(data.custom_notification.description)\n\t                        )\n\t                    )\n\t            )\n\t          );\n\t  });\n\t});\n\n\tsocket.on('post_addFriend_request', function(request_id, request){\n\n\t\tconsole.log('post_addFriend_request');\n\t\tconsole.log(request);\n\n\t\trequestHtml =  $('<li>').attr('id','friend-request-'+request.user_id).append(\n\t\t\t$('<a href=\"javascript:;\">').addClass('unread')\n\t\t\t.append(\n\t\t\t\t$('<img>').attr('src', request.profile_picture ? BASE_URL+'/'+request.profile_picture : defaultProfilePic )\n\t\t\t)\n\t\t\t.append(\n\t\t\t\t$('<p>')\n\t\t\t\t.append(\n\t\t\t\t\t$('<span>').addClass('name').text(request.name)\n\t\t\t\t)\n\t\t\t\t.append(\n\t\t\t\t\t$('<div>').addClass('actionList')\n\t\t\t\t\t.append(\n\t\t\t\t\t\t$('<button>').text('Accept').addClass('acceptFriend').data('id', request_id).data('user', request.user_id)\n\t\t\t\t\t)\n\t\t\t\t\t.append(\n\t\t\t\t\t\t$('<button>').text('Decline').addClass('declineFriend').data('id', request_id)\n\t\t\t\t\t)\n\t\t\t\t)\n\t\t\t)\n\t\t);\n\n\t\tif($('#friend-request-'+request.user_id).length)\n\t\t{\n\t\t\t$('#friend-request-'+request.user_id).replaceWith(requestHtml);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tnotifcount = $('#notificationMenu').find('.notifcount');\n\n\t\t\tif(notifcount.length)\n\t\t\t{\n\t\t\t\tnotifs = parseInt($(notifcount).text());\n\t\t\t\t$(notifcount).text(notifs+1);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t$('#notificationMenu').prepend($('<span>').addClass('notifcount').text(1));\n\t\t\t}\n\n\t\t\t$('#myNotifications').prepend( requestHtml );\n\t\t}\n\t});\n\n\tsocket.on('post_private_message', function(message){\n\n\t\tconsole.log('you got a private message!');\n\t\tconsole.log(message);\n\n\t\tif($('#pmBox').data('current') == message.from.user_id && $('#pmBox').is(':visible'))\n\t\t{\n\t\t\tconsole.log('real time add');\n\n\t\t\t$('#pmMessageContent').append(\n\t\t\t\t$('<li>').append(\n\t\t\t\t\t$('<img>').attr('src', message.from.profile_picture ? BASE_URL+'/'+message.from.profile_picture : defaultProfilePic )\n\t\t\t\t)\n\t\t\t\t.append(\n\t\t\t\t\t$('<span>').text(message.message)\n\t\t\t\t)\n\t\t\t);\n\n\t\t\t$('#pmMessageContent').animate({\n\t\t\t\tscrollTop: $('#pmMessageContent')[0].scrollHeight\n\t\t\t}, 2000);\n\t\t}\n\t\telse\n\t\t{\n\n\t\t\tif($('#inbox-user-'+message.from.user_id).length)\n\t\t\t{\n\t\t\t\t$('#inbox-user-'+message.from.user_id).find('a').addClass('unread').find('.message').text(message.message);\n\t\t\t\t$('#myMessages').prepend($('#inbox-user-'+message.from.user_id));\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t$('#myMessages').prepend(\n\t\t\t\t\t$('<li>').attr('data-user', message.from.user_id).attr('id', 'inbox-user-'+message.from.user_id)\n\t\t\t\t\t.append(\n\t\t\t\t\t\t$('<a href=\"javascript:;\">').addClass('subModalToggle pmFriend').attr('data-target', '#pmBox').addClass('unread')\n\t\t\t\t\t\t.append(\n\t\t\t\t\t\t\t$('<img>').attr('src', message.from.profile_picture ? BASE_URL+'/'+ message.from.profile_picture : defaultProfilePic )\n\t\t\t\t\t\t)\n\t\t\t\t\t\t.append(\n\t\t\t\t\t\t\t$('<p>')\n\t\t\t\t\t\t\t.append(\n\t\t\t\t\t\t\t\t$('<span>').addClass('name').text(message.from.name)\n\t\t\t\t\t\t\t\t.append($('<span>').addClass('timestamp').text('3:36pm'))\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t.append(\n\t\t\t\t\t\t\t\t$('<span>').addClass('message').text(message.message)\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t)\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\n\t\t\t$('#unreadMessageNotification').html('').append(\n\t\t\t\t$('<span>').addClass('notifcount').text($('#myMessages li a.unread').length)\n\t\t\t);\n\t\t}\n\t});\n\n\tsocket.on('open_current_room', function(room){\n\t\tif(room)\n\t\t{\n\t\t\tif($('#chatbox-'+room.id).length == 0)\n\t\t\t{\n\n\t\t\t\t$('#chatBoxPanel').append(\n\t\t\t\t\t$('<div>').addClass('chatbox-container').addClass('chatMinimized').attr('id', 'chatbox-'+room.id)\n\t\t\t\t\t.append(\n\t\t\t\t\t\t$('<div>').addClass('chatbox').data('id', room.id).data('name', room.name)\n\t\t\t\t\t\t.append(\n\t\t\t\t\t\t\t$('<div>').addClass('inactivebox')\n\t\t\t\t\t\t\t.append(\n\t\t\t\t\t\t\t\t$('<b>').text(room.name)\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t.append(\n\t\t\t\t\t\t\t\t$('<span>').addClass('peopleTalking').text(room.people.length+' people talking').data('total', room.people.length)\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t)\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}     \n\t\t}\n\t});\n\n\tsocket.on('rooms_opened', function(rooms){\n\n\t\tconsole.log(rooms);\n\n\t\t$.each(rooms, function(){\n\n\t\t\troom =this;\n\t\t\tconsole.log($('#chatBoxPanel'));\n\n\t\t\t/*     $('#chatBoxPanel').append(\n\t\t\t$('<div>').addClass('chatbox-container').addClass('chatMinimized').attr('id', 'chatbox-'+room.id)\n\t\t\t.append(\n\n\t\t\t$('<div>').addClass('chatbox').data('id', room.id).data('name', room.name)\n\t\t\t.append(\n\t\t\t$('<div>').addClass('inactivebox')\n\t\t\t.append(\n\t\t\t$('<b>').text(room.name)\n\t\t\t)\n\t\t\t.append(\n\t\t\t$('<span>').addClass('peopleTalking').text(room.people.length+' people talking').data('total', room.people.length)\n\t\t\t)\n\n\n\t\t\t)\n\t\t\t)\n\t\t\t);*/\n\n\t\t\t$.ajax({\n\t\t\t\turl : BASE_URL+'/chatroom/getUnreadCount',\n\t\t\t\ttype : 'POST',\n\t\t\t\tdata : { room_id : room.id, user_id : userId,  _token : CSRF_TOKEN },\n\t\t\t\tdataType : 'json',\n\t\t\t\tsuccess : function(count)\n\t\t\t\t{\n\n\t\t\t\t\ttextarea = $('<textarea>').addClass('common').attr('placeholder', 'Type Message').css('width', '100%');\n\n\t\t\t\t\t$('#chatBoxPanel').append(\n\t\t\t\t\t\t$('<div>').addClass('chatbox-container').addClass('chatMinimized').attr('id', 'chatbox-'+room.id)\n\t\t\t\t\t\t.append(\n\t\t\t\t\t\t\t$('<div>').addClass('chatbox').data('id', room.id).data('name', room.name)\n\t\t\t\t\t\t\t.append(\n\t\t\t\t\t\t\t\t$('<div>').addClass('inactivebox')\n\t\t\t\t\t\t\t\t.append(\n\t\t\t\t\t\t\t\t\t$('<b>').text(room.name)\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t.append(\n\t\t\t\t\t\t\t\t\t$('<span>').addClass('peopleTalking').text(room.people.length+' people talking').data('total', room.people.length)\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t)\n\n\t\t\t\t\t\t\t.append(\n\t\t\t\t\t\t\t\t\t$('<div>').addClass('activebox').css('display', 'none')\n\t\t\t\t\t\t\t\t\t.append(\n\t\t\t\t\t\t\t\t\t\t$('<div>').addClass('head')\n\t\t\t\t\t\t\t\t\t\t.append(\n\t\t\t\t\t\t\t\t\t\t\t$('<h2>')\n\t\t\t\t\t\t\t\t\t\t\t.append(\n\t\t\t\t\t\t\t\t\t\t\t\t$('<i>').addClass('fa fa-minus').addClass('minimizeChat')\n\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t// ROY: Ako sa e hide sa karon\n\n\t\t\t\t\t\t\t\t\t\t\t//.append(                    \n\t\t\t\t\t\t\t\t\t\t\t// $('<a href=\"javascript:;\">')\n\t\t\t\t\t\t\t\t\t\t\t//     .append(\n\t\t\t\t\t\t\t\t\t\t\t//       $('<i>').addClass('fa fa-times').addClass('closeChat')\n\t\t\t\t\t\t\t\t\t\t\t//       )\n\t\t\t\t\t\t\t\t\t\t\t// )\n\t\t\t\t\t\t\t\t\t\t\t.append(\n\t\t\t\t\t\t\t\t\t\t\t\t$('<a href=\"javascript:;\">').text(room.name)\n\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t.append(\n\t\t\t\t\t\t\t\t\t\t\t\t$('<span>').text(room.people.length+' people are talking now')\n\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t.append(\n\t\t\t\t\t\t\t\t\t\t$('<div>').addClass('body')\n\t\t\t\t\t\t\t\t\t)\n\n\t\t\t\t\t\t\t\t\t.append(\n\t\t\t\t\t\t\t\t\t\ttextarea\n\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t)\n\t\t\t\t\t);\n\n\t\t\t\t\tif(room.banned){\n\t\t\t\t\t\t$(textarea).initBan(room.banned);\n\t\t\t\t\t}\n\n\t\t\t\t\tif(count > 0)\n\t\t\t\t\t{\n\t\t\t\t\t\t$('#chatbox-'+room.id).find('.inactivebox')\n\t\t\t\t\t\t.append(\n\t\t\t\t\t\t\t$('<div>').addClass('notif').text(count)\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\n\t\t\t\t},\n\t\t\t\terror : function(xhr)\n\t\t\t\t{\n\t\t\t\t\tconsole.log(xhr.responseText);\n\t\t\t\t}\n\t\t\t}); \n\t\t});\n\n\t});\n\n\tsocket.on('display_people', function(people, room_id){\n\t\t$('#chatbox-'+room_id).find('.peopleTalking').text(people.length+' people are talking now');\n\t\t$('#chatbox-'+room_id).find('.activebox head span').text(people.length+' people are talking now');\n\t});\n\n\tsocket.on('room_opened', function(data, banned){\n\n\t\tsocket.emit('observer_room', data.room.id);\n\t\tconsole.log('room_opened');\n\t\tconsole.log(data);    \n\n\t\tif($('#chatbox-'+data.room.id).length == 0)\n\t\t{\n\t\t\t$.ajax({\n\t\t\t\turl : BASE_URL+'/chatroom/getUnreadCount',\n\t\t\t\ttype : 'POST',\n\t\t\t\tdata : { room_id : data.room.id, user_id : userId,  _token : CSRF_TOKEN },\n\t\t\t\tdataType : 'json',\n\t\t\t\tsuccess : function(count)\n\t\t\t\t{\n\t\t\t\t\ttextarea = $('<textarea>').addClass('common').attr('placeholder', 'Type Message').css('width', '100%');\n\n\t\t\t\t\t$('#chatBoxPanel').append(\n\t\t\t\t\t\t$('<div>').addClass('chatbox-container').addClass('chatMinimized').attr('id', 'chatbox-'+data.room.id)\n\t\t\t\t\t\t.append(\n\t\t\t\t\t\t\t$('<div>').addClass('chatbox').data('id', data.room.id).data('name', data.room.name)\n\t\t\t\t\t\t\t.append(\n\t\t\t\t\t\t\t\t$('<div>').addClass('inactivebox')\n\t\t\t\t\t\t\t\t.append(\n\t\t\t\t\t\t\t\t\t$('<b>').text(data.room.name)\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t.append(\n\t\t\t\t\t\t\t\t\t$('<span>').addClass('peopleTalking').text(data.people.length+' people talking').data('total', data.people.length)\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t).append(\n\t\t\t\t\t\t\t\t\t$('<div>').addClass('activebox').css('display', 'none')\n\t\t\t\t\t\t\t\t\t.append(\n\t\t\t\t\t\t\t\t\t\t$('<div>').addClass('head')\n\t\t\t\t\t\t\t\t\t\t.append(\n\t\t\t\t\t\t\t\t\t\t\t$('<h2>')\n\t\t\t\t\t\t\t\t\t\t\t.append(\n\t\t\t\t\t\t\t\t\t\t\t\t$('<i>').addClass('fa fa-minus').addClass('minimizeChat')\n\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t// ROY: Ako sa e hide sa karon\n\n\t\t\t\t\t\t\t\t\t\t\t//.append(                    \n\t\t\t\t\t\t\t\t\t\t\t// $('<a href=\"javascript:;\">')\n\t\t\t\t\t\t\t\t\t\t\t//     .append(\n\t\t\t\t\t\t\t\t\t\t\t//       $('<i>').addClass('fa fa-times').addClass('closeChat')\n\t\t\t\t\t\t\t\t\t\t\t//       )\n\t\t\t\t\t\t\t\t\t\t\t// )\n\t\t\t\t\t\t\t\t\t\t\t.append(\n\t\t\t\t\t\t\t\t\t\t\t\t$('<a href=\"javascript:;\">').text(data.room.name)\n\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t.append(\n\t\t\t\t\t\t\t\t\t\t\t\t$('<span>').text(data.people.length+' people are talking now')\n\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t.append(\n\t\t\t\t\t\t\t\t\t\t$('<div>').addClass('body')\n\t\t\t\t\t\t\t\t\t)\n\n\t\t\t\t\t\t\t\t\t.append(\n\t\t\t\t\t\t\t\t\t\ttextarea\n\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t)\n\n\t\t\t\t\t);\n\n\t\t\t\t\tif(banned){\n\t\t\t\t\t\t\t$(textarea).initBan(banned);\n\t\t\t\t\t\t}\n\n\t\t\t\t\tif(count > 0)\n\t\t\t\t\t{\n\t\t\t\t\t\t$('#chatbox-'+data.room.id).find('.inactivebox')\n\t\t\t\t\t\t.append(\n\t\t\t\t\t\t$('<div>').addClass('notif').text(count)\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\terror : function(xhr)\n\t\t\t\t{\n\t\t\t\t\tconsole.log(xhr.responseText);\n\t\t\t\t}\n\t\t\t});  \n\t\t} \n\t});\n\n\tsocket.on('post_chatroom_message', function(data){\n\n\t\tconsole.log('a new message from room');\n\t\tconsole.log(data);\n\n\t\tchatbox = $('#chatbox-'+data.room_id);\n\t\tif($(chatbox).length)\n\t\t{\n\n\t\t\tbody = $(chatbox).find('.body');\n\n\t\t\t$(body).append(\n\t\t\t\t$('<div>').addClass('message')\n\t\t\t\t.append(\n\t\t\t\t\t$('<div>').addClass('avatar')\n\t\t\t\t\t.append(\n\t\t\t\t\t\t$('<a href=\"javascript:;\">')\n\t\t\t\t\t\t.append(\n\t\t\t\t\t\t\t$('<img src=\"'+( data.user.profile_picture ? BASE_URL+'/'+data.user.profile_picture : defaultProfilePic) +'\">')\n\t\t\t\t\t\t)\n\t\t\t\t\t)\n\t\t\t\t)\n\t\t\t\t.append(\n\t\t\t\t\t$('<p>').addClass('bubble yellow').text(data.message)\n\t\t\t\t)\n\t\t\t);\n\n\t\t\tif($(chatbox).hasClass('chatMinimized') && userId != data.user.user_id)\n\t\t\t{\n\t\t\t\tif($(chatbox).find('.inactivebox').find('.notif').length)\n\t\t\t\t{\n\t\t\t\t\tlastCount = parseInt($(chatbox).find('.inactivebox').find('.notif').text());\n\t\t\t\t\t$(chatbox).find('.inactivebox').find('.notif').text(lastCount+1);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\t$(chatbox).find('.inactivebox').append(\n\t\t\t\t\t\t$('<div>').addClass('notif').text(1)\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n\n\tsocket.on('force_minimizeChat', function(room_id){\n\t\tchatbox = $('#chatbox-'+room_id).find('.chatbox');\n\t\tif(chatbox.length)\n\t\t{\n\t\t\tminimizeChat(chatbox);\n\t\t}\n\t});\n\n\tsocket.on('force_closeChat', function(room_id){\n\n\t\tchatbox = $('#chatbox-'+room_id).find('.chatbox');\n\t\tif(chatbox.length)\n\t\t{\n\t\t\tcloseChat(chatbox);\n\t\t\tsocket.emit('leaveChat', room_id);\n\t\t}\n\t});\n\n\tsocket.on('force_maximizeChat', function(room_id){\n\t\tchatbox = $('#chatbox-'+room_id).find('.chatbox');\n\t\tif(chatbox.length)\n\t\t{\n\t\t\tmaximizeChat(chatbox);\n\t\t}\n\t});\n\n\n\t//END SOCKET ON\n\n\t// EVENTS\n\n\t$('#globalNotifMenu').on('click', function(){\n\t\t$('#unreadGlobalNotification').html('');\n\t});\n\n\t$('#globalNotifMenu').one('click', function(e){\n\n\tbutton = this;\n\n\t$('#myGlobalNotifications').html('').append($('<li style=\"border:none;\">').addClass('loading').append('<div class=\"typing-indicator\"><span></span><span></span><span></span></div><p> Loading... </p>'));\n\n\t\t$.ajax({\n\t\turl : notifUrl+'/getGlobalNotifications',\n\t\tdata : {  _token : CSRF_TOKEN },\n\t\tdataType : 'json',\n\t\ttype : 'POST',\n\t\tsuccess : function(data)\n\t\t{\n\t\t  console.log('getGlobalNotifications');\n\t\t  console.log(data);\n\n\t\t  $(button).bind('click', readGlobalNotification);\n\n\t\t  readGlobalNotification();\n\n\t\t  $('#myGlobalNotifications').html('');\n\n\t\t  $.each(data, function(){\n\n\t\t    notification = this;\n\n\t\t    li = $('<li>');\n\n\t\t    if(notification.type == 1)\n\t\t    {\n\n\t\t      $('#myGlobalNotifications').append(\n\t\t        $(li)\n\t\t        .append(\n\t\t          $('<a href=\"'+BASE_URL+'/'+notification.game.slug+'\">')\n\t\t          .append(\n\t\t            $('<p>')\n\t\t            .append(\n\t\t              $('<span>').text('New Game has Added!')\n\t\t            )\n\t\t          )\n\t\t        )\n\t\t      );\n\n\t\t    }\n\t\t    else if(notification.type == 2)\n\t\t    {\n\n\t\t      $('#myGlobalNotifications').append(\n\t\t        $(li)\n\t\t        .append(\n\t\t          $('<a href=\"'+BASE_URL+'/clubhouse/chatroom/'+notification.room.name+'\">')\n\t\t          .append(\n\t\t            $('<p>')\n\t\t            .append(\n\t\t              $('<span>').text('New Chatroom Created!')\n\t\t            )\n\t\t          )\n\t\t        )\n\t\t      );\n\n\t\t    }\n\t\t    else if(notification.type == 3)\n\t\t    {\n\n\t\t      $('#myGlobalNotifications').append(\n\t\t        $(li)\n\t\t        .append(\n\t\t          $('<a href=\"'+BASE_URL+'/clubhouse/chatroom/'+notification.room.name+'\">')\n\t\t          .append(\n\t\t            $('<p>')\n\t\t            .append(\n\t\t              $('<span>').text(notification.moderator.user_detail.firstname+' '+notification.moderator.user_detail.lastname+' is now in '+notification.room.name)\n\t\t            )\n\t\t          )\n\t\t        )\n\t\t      );\n\t\t    }\n\t\t    else if(notification.type == 4)\n\t\t    {\n\n\t\t      $('#myGlobalNotifications').append(\n\t\t        $(li)\n\t\t        .append(\n\t\t          $('<a href=\"//'+ notification.custom_notification.link +' \">')\n\t\t          .append(\n\t\t            $('<p>')\n\t\t            .append(\n\t\t              $('<span>').text(notification.custom_notification.description)\n\t\t            )\n\t\t          )\n\t\t        )\n\t\t      );\n\n\t\t    }\n\n\n\t\t    if(!notification.globalnotification_read)\n\t\t    {\n\t\t    $(li).find('a').addClass('unread');\n\t\t    }\n\n\n\t\t  });\n\n\t\t},\n\t\terror : function(xhr)\n\t\t{\n\t\t  console.log(xhr.responseText);\n\t\t}\n\t\t});\n\t});\n\n\t$(document).on('click','.pmFriend', function(){\n\t\t$('.pmBox').css('display','block');\n\t\t$('.messageNotifBox ').hide();\n\t});\n\n\t$('#notificationMenu').on('click', function(){\n\n\t\t$('#notificationMenu').find('.notifcount').remove();\n\n\t});\n\n\t$('#notificationMenu').one('click', function(){\n\n\t\ttheButton = this;\n\n\t\t$('#myNotifications').html('').append($('<li style=\"border:none;\">').addClass('loading').append('<div class=\"typing-indicator\"><span></span><span></span><span></span></div><p> Loading... </p>'));\n\n\t\t$.ajax({\n\t\t\turl : profileUrl+'/getFriendRequests',\n\t\t\tdata : { user_id : userId, _token : CSRF_TOKEN },\n\t\t\tdataType : 'json',\n\t\t\ttype : 'POST',\n\t\t\tsuccess : function(data)\n\t\t\t{\n\t\t\t\tconsole.log('getFriendRequests');\n\t\t\t\tconsole.log(data);\n\n\t\t\t\tif(data)\n\t\t\t\t{\n\t\t\t\t\treadUserNotifications();\n\t\t\t\t\t$(theButton).bind('ckick', readUserNotifications);\n\t\t\t\t}\n\n\t\t\t\t$('#myNotifications').html('');\n\n\t\t\t\t$.each(data, function(){\n\n\t\t\t\t\tli = $('<li>');\n\n\t\t\t\t\trequest = this;\n\n\t\t\t\t\tif(request.type == 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tbutton = $('<a href=\"javascript:;\">')\n\t\t\t\t\t\t.append(\n\t\t\t\t\t\t\t$('<img>').attr('src', request.user.user_detail.profile_picture ? BASE_URL+'/'+request.user.user_detail.profile_picture : defaultProfilePic )\n\t\t\t\t\t\t)\n\t\t\t\t\t\t.append(\n\t\t\t\t\t\t\t$('<p>')\n\t\t\t\t\t\t\t.append(\n\t\t\t\t\t\t\t\t$('<span>').addClass('name').text(request.user.user_detail.firstname+' '+request.user.user_detail.lastname)\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t.append(\n\t\t\t\t\t\t\t\t$('<div>').addClass('actionList')\n\t\t\t\t\t\t\t\t.append(\n\t\t\t\t\t\t\t\t\t$('<button>').text('Accept').addClass('acceptFriend').data('id', request.id).data('user', request.user_id)\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t.append(\n\t\t\t\t\t\t\t\t\t$('<button>').text('Decline').addClass('declineFriend').data('id', request.id)\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\t$(li).attr('id', 'friend-request-'+request.user_id).append(\n\t\t\t\t\t\tbutton\n\t\t\t\t\t\t);     \n\n\t\t\t\t\t}\n\t\t\t\t\telse if(request.type == 1)\n\t\t\t\t\t{\n\t\t\t\t\t\t$(li).append(\n\t\t\t\t\t\t\t$('<a href=\"javascript:;\">')\n\t\t\t\t\t\t\t.append(\n\t\t\t\t\t\t\t$('<img>').attr('src', request.user.profile_picture ? BASE_URL+'/'+request.user.profile_picture : defaultProfilePic )\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t.append(\n\t\t\t\t\t\t\t\t$('<p>')\n\t\t\t\t\t\t\t\t.append(\n\t\t\t\t\t\t\t\t\t$('<span>').addClass('name').text('You and '+request.user.user_detail.firstname+' '+request.user.user_detail.lastname+' are now friends!')\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t.append(\n\t\t\t\t\t\t\t\t\t$('<div>').addClass('actionList').data('user', request.user.user_detail.user_id)\n\t\t\t\t\t\t\t\t\t.append(\n\t\t\t\t\t\t\t\t\t\t$('<button>').text('Message').addClass('subModalToggle pmFriend').attr('data-target', '#pmBox')\n\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t);\n\n\t\t\t\t\t}\n\t\t\t\t\telse if(request.type == 2)\n\t\t\t\t\t{\n\n\t\t\t\t\t\t$(li).append(\n\t\t\t\t\t\t\t$('<a href=\"'+BASE_URL+'/'+request.game.slug+'\">')\n\t\t\t\t\t\t\t.append(\n\t\t\t\t\t\t\t\t$('<img>').attr('src', request.user.user_detail.profile_picture ? BASE_URL+'/'+request.user.user_detail.profile_picture : defaultProfilePic )\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t.append(\n\t\t\t\t\t\t\t\t$('<p>')\n\t\t\t\t\t\t\t\t.append(\n\t\t\t\t\t\t\t\t\t$('<span>').addClass('name').text(request.user.user_detail.firstname+' '+request.user.user_detail.lastname+' recommended you to play. ')\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t.append(\n\t\t\t\t\t\t\t\t\t$('<div>').addClass('actionList')\n\t\t\t\t\t\t\t\t\t.append(\n\t\t\t\t\t\t\t\t\t\t$('<span>').text('Click to Play')\n\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\n\t\t\t\t\tif(request.read == 0)\n\t\t\t\t\t{\n\t\t\t\t\t\t$(li).find('a').addClass('unread');\n\t\t\t\t\t}\n\n\t\t\t\t\t$('#myNotifications').append(li);\n\n\t\t\t\t});\n\n\t\t\t},\n\t\t\terror : function(xhr)\n\t\t\t{\n\t\t\t\tconsole.log(xhr.responseText);\n\t\t\t}\n\t\t});\n\n\t});\n\n\t$('#sendPrivateMessage').on('submit', function(e){\n\n\t\te.preventDefault();\n\t\ttheUser = $(this).data('user');\n\t\tmessage = $('#privateMessageTextarea').val();\n\n\t\t$('#privateMessageTextarea').val('');\n\n\t\tif(theUser && message)\n\t\t{\n\n\t\t\t$('#pmMessageContent').append(\n\t\t\t\t$('<li>').addClass('alt').append(\n\t\t\t\t\t$('<span>').addClass('alt').text(message)\n\t\t\t\t)\n\t\t\t);\n\n\t\t\t$('#pmMessageContent').animate({\n\t\t\t\tscrollTop: $('#pmMessageContent')[0].scrollHeight\n\t\t\t}, 200);\n\n\t\t\t$.ajax({\n\t\t\t\turl : messageUrl+'/sendPrivateMessage',\n\t\t\t\tdata : { from : userId, to : theUser, message : message, _token : CSRF_TOKEN },\n\t\t\t\ttype : 'POST',\n\t\t\t\tdataType : 'json',\n\t\t\t\tsuccess : function(data)\n\t\t\t\t{\n\t\t\t\t\tsocket.emit('send_private_message', { to : theUser, message : message });\n\t\t\t\t},\n\t\t\t\terror : function(xhr)\n\t\t\t\t{\n\t\t\t\t\tconsole.log(xhr.responseText);\n\t\t\t\t\t// message is not send resend?\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t});\n\n\t$('.chatCommon').each(function(){\n\n\t\tvar txt = $(this),\n\t\t\thiddenDiv = $(document.createElement('div')),\n\t\t\tcontent = null;\n\n\t\ttxt.addClass('txtstuff');\n\t\thiddenDiv.addClass('hiddendiv common');\n\n\t\t$('body').append(hiddenDiv);\n\n\t\ttxt.on('keyup', function (e) {\n\n\t\t\tif (e.keyCode == 13) \n\t\t\t{\n\t\t\t\t$(txt).parent('form').submit();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcontent = $(this).val();\n\t\t\t\tcontent = content.replace(/\\n/g, '<br>');\n\t\t\t\thiddenDiv.html(content + '<br class=\"lbr\">');\n\t\t\t\t$(this).css('height', hiddenDiv.height());\n\t\t\t}\n\n\t\t});\n\n\t});\n\n\t$(document).on('click', '.pmFriend', function(){\n\n\t\tmodal = $('#pmBox');\n\n\t\t$(this).removeClass('unread');\n\n\t\tif(!modal.hasClass('loading'))\n\t\t{\n\t\t\t$(modal).addClass('loading');\n\t\t\ttheUser = $(this).parent().data('user');\n\t\t\t$('#pmBox').attr('data-current', theUser);\n\t\t\t$('#sendPrivateMessage').data('user', theUser);\n\t\t\t$(modal).find('.divContainer').hide();\n\n\t\t\tloading = $('<div>').addClass('loadContainer').append('<div class=\"typing-indicator\"><span></span><span></span><span></span></div><p> Loading... </p>');\n\n\t\t\t$(modal).append(loading);\n\t\t\t$('#pmMessageContent').html('');\n\n\t\t\t$.ajax({\n\t\t\t\turl : messageUrl+'/getPrivateMessages',\n\t\t\t\tdata : { user_id : userId , other_person : theUser , _token : CSRF_TOKEN },\n\t\t\t\tdataType : 'json',\n\t\t\t\ttype : 'POST',\n\t\t\t\tsuccess : function(data)\n\t\t\t\t{\n\t\t\t\t\t$('#unreadMessage').text('('+data['unread']+')');\n\t\t\t\t\t$('#readMessage').text('('+data['read']+')');\n\n\t\t\t\t\t$(modal).find('.divContainer').show();\n\t\t\t\t\t$(loading).remove();\n\t\t\t\t\tmodal.removeClass('loading');\n\n\t\t\t\t\t$('#pmName').text( data.other_person.user_detail.firstname +' '+ data.other_person.user_detail.lastname);\n\n\t\t\t\t\tif(data.conversation && data.conversation.length > 0)\n\t\t\t\t\t{\n\t\t\t\t\t\t$.each(data.conversation, function(){\n\n\t\t\t\t\t\t\tli = $('<li>');\n\n\t\t\t\t\t\t\tspan = $('<span>').text(this.message);\n\n\t\t\t\t\t\t\tif(this.from != userId)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t$(li).append(                        \n\t\t\t\t\t\t\t\t\t$('<img>').attr('src', data.other_person.user_detail.profile_picture ? BASE_URL+'/'+data.other_person.user_detail.profile_picture : defaultProfilePic )                        \n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t$(li).addClass('alt');\n\t\t\t\t\t\t\t\t$(span).addClass('alt');\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t$('#pmMessageContent').append(\n\t\t\t\t\t\t\tli.append(span)\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t},\n\t\t\t\terror : function(xhr)\n\t\t\t\t{\n\t\t\t\t\tconsole.log(xhr.responseText);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t});\n\n  \n\t$('#myNotifications').on('click', '.acceptFriend', function(){\n\n\t\tdata_id = $(this).data('id');\n\t\tuser = $(this).data('user');\n\n\t\t$(this).parents('li').find('.actionList').html('')\n\n\t\t.append(\n\t\t\t$('<span>').text('Request accepted! ').css('font-size', '12px').data('user', user)\n\t\t\t.append(\n\t\t\t\t$('<button>').text('Message').addClass('subModalToggle pmFriend').attr('data-target', '#pmBox')\n\t\t\t)\n\t\t);\n\n\t\t$.ajax({\n\t\t\turl : friendUrl+'/acceptFriendRequest',\n\t\t\tdata : { _token : CSRF_TOKEN, id : data_id },\n\t\t\ttype : 'POST',\n\t\t\tdataType : 'json',\n\t\t\tsuccess : function(data)\n\t\t\t{\n\t\t\t\tif(data)\n\t\t\t\t{\n\t\t\t\t\tsocket.emit('friend_request_accepted', { other_person : user });\n\t\t\t\t}\n\t\t\t},\n\t\t\terror : function (xhr)\n\t\t\t{\n\t\t\t\tconsole.log(xhr.responseText);\n\t\t\t}\n\t\t});\n\t});\n  \n\t$('#myNotifications').on('click', '.declineFriend', function(){\n\n\t\tdata_id = $(this).data('id');\n\n\t\t$(this).parents('li').remove();\n\n\t\t$.ajax({\n\t\t\turl : friendUrl+'/cancelFriendRequest',\n\t\t\tdata : { _token : CSRF_TOKEN, id : data_id },\n\t\t\ttype : 'POST',\n\t\t\tdataType : 'json',\n\t\t\tsuccess : function(data)\n\t\t\t{\n\t\t\t\tconsole.log(data);\n\t\t\t},error : function (xhr)\n\t\t\t{\n\t\t\t\tconsole.log(xhr.responseText);\n\t\t\t}\n\t\t});\n\t});\n\n\t$('#messagesMenu').one('click', function(){\n\n\t\t$('#myMessages').html('').append($('<li style=\"border:none;\">').addClass('loading').append('<div class=\"typing-indicator\"><span></span><span></span><span></span></div><p> Loading... </p>'));\n\n\t\t$.ajax({\n\t\t\turl : messageUrl+'/getInbox',\n\t\t\tdata : { user_id : userId, _token : CSRF_TOKEN },\n\t\t\tdataType : 'json',\n\t\t\ttype : 'POST',\n\t\t\tsuccess : function(data)\n\t\t\t{\n\t\t\t\tsortDates = data.sort(function(a, b){\n\t\t\t\t\treturn new Date(a.created_at) < new Date(b.created_at);\n\t\t\t\t});\n\n\t\t\t\tunread_messages = [];\n\t\t\t\tread_messages = [];\n\n\t\t\t\t$.each(sortDates, function(){\n\n\t\t\t\t\tif(this.read == 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tunread_messages.push(this);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tread_messages.push(this);\n\t\t\t\t\t}\n\n\t\t\t\t});\n\n\t\t\t\tinbox = unread_messages.concat(read_messages);\n\n\t\t\t\t$('#myMessages').html('');\n\n\t\t\t\t$.each(inbox, function(){\n\n\t\t\t\t\tmsg = this;\n\n\t\t\t\t\tbutton = $('<a href=\"javascript:;\">').addClass('subModalToggle pmFriend').attr('data-target', '#pmBox')\n\t\t\t\t\t.append(\n\t\t\t\t\t\t$('<img>').attr('src', msg.from_user.user_detail.profile_picture ? BASE_URL+'/'+ msg.from_user.user_detail.profile_picture : defaultProfilePic )\n\t\t\t\t\t)\n\t\t\t\t\t.append(\n\t\t\t\t\t\t$('<p>')\n\t\t\t\t\t\t.append(\n\t\t\t\t\t\t\t$('<span>').addClass('name').text(msg.from_user.user_detail.firstname+' '+msg.from_user.user_detail.lastname)\n\t\t\t\t\t\t\t.append($('<span>').addClass('timestamp').text('3:36pm'))\n\t\t\t\t\t\t)\n\t\t\t\t\t\t.append(\n\t\t\t\t\t\t\t$('<span>').addClass('message').text(msg.message)\n\t\t\t\t\t\t)\n\t\t\t\t\t);\n\n\t\t\t\t\tif(msg.read == 0)\n\t\t\t\t\t{\n\t\t\t\t\t\t$(button).addClass('unread');\n\t\t\t\t\t}\n\n\t\t\t\t\t$('#myMessages').append(\n\t\t\t\t\t\t$('<li>').attr('id', 'inbox-user-'+msg.from_user.user_detail.user_id).attr('data-user', msg.from_user.user_detail.user_id)\n\t\t\t\t\t\t.append(\n\t\t\t\t\t\t\tbutton\n\t\t\t\t\t\t)\n\t\t\t\t\t);\n\t\t\t\t});\n\t\t\t},\n\t\t\terror : function(xhr)\n\t\t\t{\n\t\t\t\tconsole.log(xhr.responseText);\n\t\t\t}\n\t\t});\n\t});\n\n\t$('#myMessages').on('click', 'li a', function(){\n\t\t$('#unreadMessageNotification').html('');\n\t});\n\n\t$('#messagesMenu').on('click', function(){\n\t\t$('#unreadMessageNotification').html('');\n\t});\n\n\t$('#userMenu').click(function(){\n\t\t$('.profileBox').toggle();\n\t});\n\n\t$('#messagesMenu').click(function(){\n\t\t$('.messageNotifBox').toggle();\n\t\t$('.globalNotifBox ').hide();\n\t\t$('.notificationBox ').hide();\n\t});\n\n\n\t$('#globalNotifMenu').click(function(){\n\t\t$('.globalNotifBox').toggle();\n\t\t$('.messageNotifBox ').hide();\n\t\t$('.notificationBox ').hide();\n\t});\n\n\t$('#notificationMenu').click(function(){\n\t\t$('.notificationBox').toggle();\n\t\t$('.globalNotifBox ').hide();\n\t\t$('.messageNotifBox ').hide();\n\t});\n\n\n\t$('.messageBox ul').slimScroll({\n\t\theight: '366px',\n\t\tstart: 'bottom'\n\t});\n\n\t$('#chatBoxPanel').on('click', '.minimizeChat', function(e){\n\n\t\te.stopPropagation();\n\t\tchatbox = $(this).parents('.chatbox');\n\t\troom_id = $(chatbox).data('id');\n\t\tminimizeChat(chatbox);\n\t\tsocket.emit('chat_minimized', room_id);\n\t});\n\n\t$('#chatBoxPanel').on('click', '.closeChat', function(e){\n\t\te.stopPropagation();\n\t\tchatbox = $(this).parents('.chatbox');\n\t\troom_id = $(chatbox).data('id');\n\t\tcloseChat(chatbox);\n\t\tsocket.emit('stop_observing', room_id);\n\t});\n\n\t$('#chatBoxPanel').on('keydown', 'textarea', function(e){\n\n\t\tif(e.keyCode == 13)\n\t\t{\n\t\t\tmessage = $(this).val();\n\t\t\tchatbox = $(this).parents('.chatbox');\n\t\t\troom_id = $(chatbox).data('id');\n\n\t\t\tif(message && userId && room_id)\n\t\t\t{\n\t\t\t\t$(this).val('');\n\t\t\t\tbody = $(this).parents('.activebox').find('.body');\n\n\t\t\t\tconsole.log(body);\n\n\t\t\t\t$(body).append(\n\t\t\t\t\t$('<div>').addClass('message')\n\t\t\t\t\t.append(\n\t\t\t\t\t\t$('<div>').addClass('avatar')\n\t\t\t\t\t\t.append(\n\t\t\t\t\t\t\t$('<a href=\"javascript:;\">')\n\t\t\t\t\t\t\t// .append(\n\t\t\t\t\t\t\t//   $('<img src=\"img/assets/chat-avatar-shine.png\">').addClass('shine')\n\t\t\t\t\t\t\t//   )\n\t\t\t\t\t\t\t.append(\n\t\t\t\t\t\t\t\t$('<img src=\"'+( userImage ? BASE_URL+'/'+userImage : defaultProfilePic) +'\">')\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t)\n\t\t\t\t\t)\n\t\t\t\t\t.append(\n\t\t\t\t\t\t$('<p>').addClass('bubble yellow').text(message)\n\t\t\t\t\t)\n\t\t\t\t);\n\n\t\t\t\t$.ajax({\n\t\t\t\t\turl : BASE_URL+\"/chatroom/postMessage\",\n\t\t\t\t\ttype : 'POST',\n\t\t\t\t\tdata : { user_id : userId , message : message, room_id : room_id , _token : CSRF_TOKEN },\n\t\t\t\t\tdataType : 'json',\n\t\t\t\t\tsuccess : function(data)\n\t\t\t\t\t{\n\t\t\t\t\t\tsocket.emit('send_chatroom_message', room_id, message );\n\t\t\t\t\t},\n\t\t\t\t\terror : function(xhr)\n\t\t\t\t\t{\n\t\t\t\t\t\tconsole.log(xhr.responseText);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tscrollDownChatBody();\n\t\t\t}\n\t\t}\n\n\t});\n\n\t$('#chatBoxPanel').on('keyup', 'textarea', function(e){\n\t\tif(e.keyCode == 13)\n\t\t{\n\t\t\t$(this).val('');\n\t\t}\n\t});\n\n\n\t$('#chatBoxPanel').on('click','.chatbox', function(e){\n\t\troom_id = $(this).data('id');\n\t\tmaximizeChat(this);\n\t\tif(room_id)\n\t\t{\n\t\t\tsocket.emit('chat_maximized', room_id);\n\t\t}\n\t});\n\n\t$(\".categ-button\").click(function(){\n\t\t$(\".categ-entries\").fadeToggle();\n\t});\n\n\t$('body').on('click', function(e){\n\n\t\tif( $('.categ-entries').is(':visible') && ( !$(e.target).hasClass('categ-entries') && !$(e.target).hasClass('categ-button')))\n\t\t{\n\t\t\t$(\".categ-entries\").fadeOut();\n\t\t} \n\n\t});\n\n\t// END EVENTS\n\n\t// FUNCTIONS\n\n\tfunction readGlobalNotification(){\n\t\t$.ajax({\n\t\t  url : notifUrl+'/readGlobalNotifications',\n\t\t  data : { _token : CSRF_TOKEN },\n\t\t  dataType : 'json',\n\t\t  type : 'POST',\n\t\t  success : function(data)\n\t\t  {\n\t\t    console.log('readGlobalNotification');\n\t\t    console.log(data);\n\t\t  },\n\t\t  error : function(xhr)\n\t\t  {\n\t\t    console.log(xhr.responseText);\n\t\t  }\n\t\t});\n\t}\n\n\tfunction readUserNotifications(){\n\t\t$.ajax({\n\t\t\turl : profileUrl+'/readFriendRequests',\n\t\t\tdata : { user_id : userId, _token : CSRF_TOKEN },\n\t\t\tdataType : 'json',\n\t\t\ttype : 'POST',\n\t\t\tsuccess : function(data)\n\t\t\t{\n\t\t\t \n\t\t\t console.log('readFriendRequests');\n\t\t\t console.log(data);\n\n\t\t\t},\n\t\t\terror : function(xhr)\n\t\t\t{\n\t\t\t  console.log(xhr.responseText);\n\t\t\t}\n\t\t});\n\t}\n\n\tfunction minimizeChat(chatbox){\n\n\t\tconsole.log('minimizeChat');\n\t\tchatbox.find('.inactivebox').css('display', 'block');\n\t\tchatbox.find('.activebox').css('display', 'none');\n\t\tchatbox.parent().removeClass('chatMaximized').addClass('chatMinimized');\n\t}\n\n\tfunction maximizeChat(chatbox){\n\n\t\troom_id = $(chatbox).data('id');\n\t\troom_name = $(chatbox).data('name');\n\t\tpeopleTalking = $(chatbox).find('.peopleTalking').data('total');\n\t\t$(chatbox).find('.notif').remove();\n\t\t$(chatbox).parent().removeClass('chatMinimized').addClass('chatMaximized');\n\n\n\t\tif(room_id)\n\t\t{\n\n\t\t\t$.ajax({\n\t\t\t\turl : BASE_URL+'/chatroom/userChatRead',\n\t\t\t\ttype : 'POST',\n\t\t\t\tdata : { user_id : userId, room_id : room_id, _token : CSRF_TOKEN },\n\t\t\t\tdataType : 'json',\n\t\t\t\tsuccess : function(data)\n\t\t\t\t{\n\t\t\t\t\t// console.log(data);\n\t\t\t\t\tconsole.log('User is looged in')\n\t\t\t\t},\n\t\t\t\terror : function(xhr)\n\t\t\t\t{\n\t\t\t\t\tconsole.log('User is not logged in');\n\t\t\t\t\t// console.log(xhr.responseText);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t$(chatbox).find('.inactivebox').hide();\n\n\t\t\tif($(chatbox).find('.activebox .message').length > 0)\n\t\t\t{\n\t\t\t\t$(chatbox).find('.activebox').show();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t$(chatbox).find('.activebox').show();\n\t\t\t\tbody = $(chatbox).find('.body');\n\n\t\t\t\tif(!userId)\n\t\t\t\t{\n\n\t\t\t\t\t$(chatbox).find('.activebox textarea')\n\t\t\t\t\t.replaceWith(\n\t\t\t\t\t\t$('<div>').addClass('joinBox')\n\t\t\t\t\t\t.append(\n\t\t\t\t\t\t\t$('<a href=\"'+BASE_URL+'/login\">').addClass('join').text('Join Chat')\n\t\t\t\t\t\t)\n\t\t\t\t\t);\n\n\t\t\t\t}\n\t\t\t\t\n\n\t\t\t\t$.ajax({\n\t\t\t\t\turl : BASE_URL+'/room/getRoomMessages',\n\t\t\t\t\tdata : { room_id : room_id, _token : CSRF_TOKEN },\n\t\t\t\t\ttype : 'POST',\n\t\t\t\t\tdataType : 'json',\n\t\t\t\t\tsuccess : function(data)\n\t\t\t\t\t{\n\t\t\t\t\t\t$.each(data, function(){\n\t\t\t\t\t\t\t$(body)\n\t\t\t\t\t\t\t.append(\n\t\t\t\t\t\t\t\t$('<div>').addClass('message')\n\t\t\t\t\t\t\t\t.append(\n\t\t\t\t\t\t\t\t\t$('<div>').addClass('avatar')\n\t\t\t\t\t\t\t\t\t.append(\n\t\t\t\t\t\t\t\t\t\t$('<a href=\"javascript:;\">')\n\t\t\t\t\t\t\t\t\t\t// .append(\n\t\t\t\t\t\t\t\t\t\t//   $('<img src=\"img/assets/chat-avatar-shine.png\">').addClass('shine')\n\t\t\t\t\t\t\t\t\t\t//   )\n\t\t\t\t\t\t\t\t\t\t.append(\n\t\t\t\t\t\t\t\t\t\t\t$('<img src=\"'+( this.user.user_detail.profile_picture ? BASE_URL+'/'+this.user.user_detail.profile_picture : defaultProfilePic) +'\">')\n\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t.append(\n\t\t\t\t\t\t\t\t$('<p>').addClass('bubble yellow').text(this.message)\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tscrollDownChatBody();\n\t\t\t\t\t},\n\t\t\t\t\terror : function(xhr)\n\t\t\t\t\t{\n\t\t\t\t\t\tconsole.log(xhr.responseText);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\n\t}\n\n\tfunction closeChat(chatbox){\n\n\t\t$(chatbox).parent('.chatbox-container').remove();\n\n\t}\n\n\tfunction scrollDownChatBody(){\n\n\t\t$('#chatBoxPanel').find('.body').scrollTop($('#chatBoxPanel').find('.body')[0].scrollHeight);\n\t}\n\n\t// END FUNCTIONS\n\n});","$(function(){\n\n\t$('#search').on('input', function(e){\n\t\tvar searchField = $('#search').val(),\n\t\ttimer = $('#search').data('timeout');\n\n\t\t$(\"#mainhead\").css({\n\t\t\t\"position\":\"relative\",\n\t\t\t\"z-index\":\"999\",\n\t\t});\n\n\t\t$(\".overlay\").css({\n\t\t\t\"background-color\":\"rgba(0, 0, 0, 0.41)\",\n\t\t\t\"position\": \"fixed\",\n\t\t\t\"width\": \"100%\",\n\t\t\t\"height\": \"100%\",\n\t\t\t\"z-index\": \"98\",\n\t\t});\n\n\t\t$('#search_result').html('<div id=\"floatingCirclesG\"  style=\"display:block;\"><div class=\"f_circleG\" id=\"frotateG_01\"></div><div class=\"f_circleG\" id=\"frotateG_02\"></div><div class=\"f_circleG\" id=\"frotateG_03\"></div><div class=\"f_circleG\" id=\"frotateG_04\"></div><div class=\"f_circleG\" id=\"frotateG_05\"></div><div class=\"f_circleG\" id=\"frotateG_06\"></div><div class=\"f_circleG\" id=\"frotateG_07\"></div><div class=\"f_circleG\" id=\"frotateG_08\"></div></div>');\n\n\t\t$(\"#search_result\").css({\n\t\t\t\"background\": \"#ffffff\"          \n\t\t});\n\n\t\tif(timer) \n\t\t{\n\t\t\tclearTimeout(timer);\n\t\t\t$('#search').removeData('timeout');\n\t\t}\n\n\t\tif( searchField == 0 || searchField == '' || searchField == null ) \n\t\t{\n\t\t\t$('#search_result').html('<h6>NO RESULTS FOUND</h6>');\n\t\t} \n\t\telse if (e.which == 13) \n\t\t{\n\t\t\te.preventDefault();\n\t\t\tget_search_result(searchField);\n\t\t}\n\t\telse \n\t\t{\n\t\t\t$('#search').data('timeout', setTimeout(get_search_result, 1000 * 0.5,searchField));\n\t\t}\n\n\t});\n\n\tfunction get_search_result(searchField)\n\t{\n\t\t$.ajax({\n\t\t\ttype: 'post',\n\t\t\turl: BASE_URL+'/home/ajax_get_posts',\n\t\t\tdata: {_token: CSRF_TOKEN,'searchField' : searchField}, \n\t\t\tsuccess: function(response)\n\t\t\t{\n\t\t\t\tvar parsed = JSON.parse(response),\n\t\t\t\toutput = '';\n\t\t\t\t$.each( parsed, function( index, obj){\n\n\t\t\t\t\toutput += '<a class=\"entry\" tabindex=\"1\" href=\"'+BASE_URL+'/' +obj.slug+ '\" ><img src=\"'+BASE_URL+'/uploads/'+obj.icon_feature_image+'\" width=\"100px\" height=\"100px\"> <p>' +obj.title+ '</p> <div class=\"searchratingouter\"> <span class=\"searchrating\" style=\"width:'+Math.floor(obj.total_rating)+'%;\"> &nbsp; </span> </div> </a>';\n\n\t\t\t\t});\n\n\t\t\t\tif(output.trim() == '')\n\t\t\t\t{\n\t\t\t\t\t$('#search_result').html('<h6>NO RESULTS FOUND</h6>');\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\t$('#search_result').html(output);\n\t\t\t\t}\n\n\t\t\t}\n\t\t});\n\t}\n\n\n\t$('#search').on('keyup', function(e){\n\t\tif(e.which == 40)\n\t\t{\n\t\t\t$('#search_result').find('.entry:first-child').focus().trigger('keydown');\n\t\t}\n\t});\n\n\t$('#search_result').on('focusin', '.entry', function(){\n\n\t    $(this).css({'outline' : 0, 'background' : '#E8E8E8'});\n\n\t}).on('focusout','.entry', function(){\n\n\t  \t$(this).css({'background' : '#fff'});\n\n\t});\n\n\t$('#search_result').on('keydown','.entry:focus', function(e){\n\n\t\tif(e.which == 40 || e.which == 38)\n\t\t{\n\t\t\tif(e.which == 40)\n\t\t\t{\n\t\t\t\t$(this).next().focus();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif($(this).index() == 0)\n\t\t\t\t{\n\t\t\t\t\t$('#search').focus();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\t$(this).prev().focus();\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn false;\n\t\t}\n\t});\n\n  $(\".overlay\").click(function(){\n      $(this).css({\n           \"background\":\"none\",\n            \"z-index\": \"0\",\n            \"cursor\" : \"auto\"\n          }); \n      $('#search_result').html('');\n  });\n\n});"],"sourceRoot":"/source/"}